---
title: "Challenge-5"
author: "Esther Kho Yining"
date: "2024-02-13"
output:
  pdf_document: default
  html_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Questions
<br>

#### Question-1: Local Variable Shadowing 

Create an R function that defines a global variable called `x` with a value of 5. Inside the function, declare a local variable also named `x` with a value of 10. Print the value of `x` both inside and outside the function to demonstrate shadowing.

**Solutions:**

```{r, eval=TRUE,echo=TRUE}
# Enter code here
shadowing_example <- function() { 
  x <- 10
cat("Value of x inside the function:", x, "\n") 
}
x <- 5
cat("Value of x outside the function:", x, "\n")
```

```{r, eval=TRUE,echo=TRUE}
shadowing_example()
```

```{r, eval=TRUE,echo=TRUE}

cat("Value of x outside the function after shadowing:", x, "\n")
```
<br>

#### Question-2: Modify Global Variable

Create an R function that takes an argument and adds it to a global variable called `total`. Call the function multiple times with different arguments to accumulate the values in `total`.

**Solutions:**

```{r, eval=TRUE,echo=TRUE}
# Enter code here
total <- 1
accumulate_total <- function(value) { 
  total <<- total + value}

accumulate_total(5) 
accumulate_total(10) 
accumulate_total(15)

print(total)
```
<br>

#### Question-3: Global and Local Interaction 

Write an R program that includes a global variable `total` with an initial value of 100. Create a function that takes an argument, adds it to `total`, and returns the updated `total`. Demonstrate how this function interacts with the global variable.

**Solutions:**

```{r, eval=TRUE,echo=TRUE}
# Enter code here
total <- 100
add_to_total <- function(num) { 
  total <<- total + num 
  return(total)
}

cat("Initial value of total:", total, "\n")
```

```{r, eval=TRUE,echo=TRUE}
result1 <- add_to_total(25)
cat("After adding 25, total becomes:", result1, "\n")
```

```{r, eval=TRUE,echo=TRUE}
result2 <- add_to_total(50)
cat("After adding 50, total becomes:", result2, "\n")
```

```{r, eval=TRUE,echo=TRUE}
cat("Final value of total:", total, "\n")
```

<br>

#### Question-4: Nested Functions

Define a function `outer_function` that declares a local variable `x` with a value of 5. Inside `outer_function`, define another function `inner_function` that prints the value of `x`. Call both functions to show how the inner function accesses the variable from the outer function's scope.

**Solutions:**

```{r, eval=TRUE,echo=TRUE}
outer_function <- function() { 
  x <- 5
  inner_function <- function() { 
    print(x)
  }
  inner_function() 
}

outer_function()
```
<br>

#### Question-5: Meme Generator Function

Create a function that takes a text input and generates a humorous meme with the text overlaid on an image of your choice. You can use the `magick` package for image manipulation. You can find more details about the commands offered by the package, with some examples of annotating images here: https://cran.r-project.org/web/packages/magick/vignettes/intro.html

**Solutions:**

```{r, eval=FALSE,echo=TRUE}
install.packages("magick")
```
```{r, eval=TRUE,echo=TRUE}
library(magick)
```

```{r, eval=TRUE,echo=TRUE, error=TRUE}
generate_meme <- function(text_input, image_path) {   
  image <- image_read(image_path)
  image <- image_scale(image, "200")
  image_with_text <- image_annotate(image, text_input, gravity = "center", size = 50, 
                                    color = "black", font = "Impact")   
  print(image_with_text) 
}  

text_input <- "when you got work to clear during CNY" 
image_path <- "Squidward_meme.jpg" 
generate_meme(text_input, image_path)
```
##Note: I'm a macbook user

<br>

#### Question-6: Text Analysis Game  

Develop a text analysis game in which the user inputs a sentence, and the R function provides statistics like the number of words, characters, and average word length. Reward the user with a "communication skill level" based on their input.

**Solutions:**

```{r, eval=TRUE,echo=TRUE}
# Enter code here
text_analysis_game <- function(){   
  sentence <- readline("Enter a sentence: ")   
  sentence <- trimws(sentence) 
  words <- strsplit(sentence, "\\s+")[[1]]
  num_words <- length(words) 
  num_chars <- nchar(sentence) 
  avg_word_length <- mean(nchar(words))  
  
skill_level <- ifelse(num_words >=10 & avg_word_length >=5, "Advanced", 
ifelse(num_words >= 5 & avg_word_length >= 4, "Intermediate", "Beginner"))  

stats <- list( 
  num_words = num_words, 
  num_chars = num_chars, 
  avg_word_length = avg_word_length)  

print(paste("Number of words:", stats$num_words)) 
print(paste("Number of characters:", stats$num_chars)) 
print(paste("Average word length:", stats$avg_word_length)) 
print(paste("Skill Level:", skill_level)) 
return(list(stats=stats, skill_level=skill_level)) }   

text_analysis_game()
```

<br>